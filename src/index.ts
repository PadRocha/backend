import './database';

import dotenv from 'dotenv';
import fs from 'fs-extra';
import path from 'path';

import app from './app';
import { field, sep, title } from './config/fmt';

/**
 * #  ██████╗███████╗████████╗██████╗ ██╗ ██████╗ ██████╗    ██████╗ ██████╗  ██████╗ ██████╗ ██╗   ██╗ ██████╗████████╗██╗ ██████╗ ███╗   ██╗███████╗
 * # ██╔════╝██╔════╝╚══██╔══╝██╔══██╗██║██╔════╝██╔═══██╗   ██╔══██╗██╔══██╗██╔═══██╗██╔══██╗██║   ██║██╔════╝╚══██╔══╝██║██╔═══██╗████╗  ██║██╔════╝
 * # ██║     █████╗     ██║   ██████╔╝██║██║     ██║   ██║   ██████╔╝██████╔╝██║   ██║██║  ██║██║   ██║██║        ██║   ██║██║   ██║██╔██╗ ██║███████╗
 * # ██║     ██╔══╝     ██║   ██╔══██╗╚═╝██║     ██║   ██║   ██╔═══╝ ██╔══██╗██║   ██║██║  ██║██║   ██║██║        ██║   ██║██║   ██║██║╚██╗██║╚════██║
 * # ╚██████╗███████╗   ██║   ██║  ██║██╗╚██████╗╚██████╔╝██╗██║     ██║  ██║╚██████╔╝██████╔╝╚██████╔╝╚██████╗   ██║   ██║╚██████╔╝██║ ╚████║███████║
 * #  ╚═════╝╚══════╝   ╚═╝   ╚═╝  ╚═╝╚═╝ ╚═════╝ ╚═════╝ ╚═╝╚═╝     ╚═╝  ╚═╝ ╚═════╝ ╚═════╝  ╚═════╝  ╚═════╝   ╚═╝   ╚═╝ ╚═════╝ ╚═╝  ╚═══╝╚══════╝
 */

dotenv.config();

(async () => {
  const simba = await fs.readFileSync(path.join(__dirname, '../assets/Simba-ASCII-78-black.ans'));
  const server = await app.listen(app.get('port'));
  console.log(simba.toString('utf8'));
  sep();
  title(`{${app.get('pkg').name}} - ${app.get('pkg').description}`);
  field('\x1b[37mServer', `\x1b[33m${app.get('port')}\x1b[0m`);
  field('\x1b[37mStatus', `\x1b[33m${app.get('env')}\x1b[0m`);
})();